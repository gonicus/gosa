<?xml version="1.0" encoding="UTF-8"?>
<Objects xmlns="http://www.gonicus.de/Objects">
  <Object>
    <Name>ZarafaAccount</Name>
    <DisplayName>Zarafa</DisplayName>
    <Description>Zarafa: an user of Zarafa</Description>
    <Templates>
      <Template>user-zarafa.json</Template>
    </Templates>
    <BackendParameters>
      <Backend objectClasses="zarafa-user,gosaMailAccount,goZarafaAddons">LDAP</Backend>
    </BackendParameters>
    <Backend>LDAP</Backend>
    <BaseObject>false</BaseObject>
    <Attributes>
      <ForeignAttribute>
        <Name>cn</Name>
      </ForeignAttribute>
      <ForeignAttribute>
        <Name>givenName</Name>
      </ForeignAttribute>
      <ForeignAttribute>
        <Name>sn</Name>
      </ForeignAttribute>
      <ForeignAttribute>
        <Name>uidNumber</Name>
      </ForeignAttribute>
      <Attribute>
        <Name>zarafaQuotaOverride</Name>
        <Description>ZARAFA: Override child quota</Description>
        <Default>false</Default>
        <Type>Boolean</Type>
        <BackendType>Integer</BackendType>
        <InFilter>
            <FilterChain>
                <FilterEntry>
                    <Filter>
                        <Name>IntegerToBoolean</Name>
                    </Filter>
                </FilterEntry>
            </FilterChain>
        </InFilter>
        <OutFilter>
            <FilterChain>
                <FilterEntry>
                    <Filter>
                        <Name>BooleanToInteger</Name>
                    </Filter>
                </FilterEntry>
            </FilterChain>
        </OutFilter>
      </Attribute>
      <Attribute>
        <Name>zarafaQuotaWarn</Name>
        <Description>ZARAFA: Warning quota size in MB</Description>
        <Type>Integer</Type>
        <Validators>
          <Condition>
            <Name>Smaller</Name>
            <Param>zarafaQuotaSoft</Param>
            <Param>zarafaQuotaHard</Param>
          </Condition>
        </Validators>
        <BlockedBy>
          <Attribute value="false">zarafaQuotaOverride</Attribute>
        </BlockedBy>
      </Attribute>
      <Attribute>
        <Name>zarafaQuotaSoft</Name>
        <Description>ZARAFA: Soft quota size in MB</Description>
        <Type>Integer</Type>
        <Validators>
          <Condition>
            <Name>Greater</Name>
            <Param>zarafaQuotaWarn</Param>
          </Condition>
        </Validators>
        <BlockedBy>
          <Attribute value="false">zarafaQuotaOverride</Attribute>
        </BlockedBy>
      </Attribute>
      <Attribute>
        <Name>zarafaQuotaHard</Name>
        <Description>ZARAFA: Hard quota size in MB</Description>
        <Type>Integer</Type>
        <Validators>
          <Condition>
            <Name>Greater</Name>
            <Param>zarafaQuotaSoft</Param>
            <Param>zarafaQuotaWarn</Param>
          </Condition>
        </Validators>
        <BlockedBy>
          <Attribute value="false">zarafaQuotaOverride</Attribute>
        </BlockedBy>
      </Attribute>
      <Attribute>
        <Name>zarafaSendAsPrivilege</Name>
        <Description>ZARAFA: Users may directly send email as this user</Description>
        <Type>UnicodeString</Type>
        <Validators>
          <Condition>
            <Name>ObjectWithPropertyExists</Name>
            <Param>ZarafaUser</Param>
            <Param>dn</Param>
          </Condition>
        </Validators>
        <References>
          <Reference>
            <Object>ZarafaUser</Object>
            <Attribute>dn</Attribute>
          </Reference>
        </References>
        <MultiValue>true</MultiValue>
      </Attribute>
      <Attribute>
        <Name>zarafaAdmin</Name>
        <Description>ZARAFA: Administrator of zarafa</Description>
        <Type>Boolean</Type>
        <BackendType>Integer</BackendType>
        <InFilter>
            <FilterChain>
                <FilterEntry>
                    <Filter>
                        <Name>IntegerToBoolean</Name>
                    </Filter>
                </FilterEntry>
            </FilterChain>
        </InFilter>
        <OutFilter>
            <FilterChain>
                <FilterEntry>
                    <Filter>
                        <Name>BooleanToInteger</Name>
                    </Filter>
                </FilterEntry>
            </FilterChain>
        </OutFilter>
      </Attribute>
      <Attribute>
        <Name>zarafaSharedStoreOnly</Name>
        <Description>ZARAFA: is store a shared store</Description>
        <Type>Boolean</Type>
        <BackendType>Integer</BackendType>
        <InFilter>
            <FilterChain>
                <FilterEntry>
                    <Filter>
                        <Name>IntegerToBoolean</Name>
                    </Filter>
                </FilterEntry>
            </FilterChain>
        </InFilter>
        <OutFilter>
            <FilterChain>
                <FilterEntry>
                    <Filter>
                        <Name>BooleanToInteger</Name>
                    </Filter>
                </FilterEntry>
            </FilterChain>
        </OutFilter>
      </Attribute>
      <Attribute>
        <Name>zarafaResourceType</Name>
        <Description>ZARAFA: for shared stores, resource is type Room or Equipment</Description>
        <Type>UnicodeString</Type>
        <Mandatory>true</Mandatory>
        <Values>
          <Value key="0"></Value>
          <Value key="user">User</Value>
          <Value key="room">Room</Value>
          <Value key="equipment">Equipment</Value>
        </Values>
      </Attribute>
      <Attribute>
        <Name>zarafaResourceCapacity</Name>
        <Description>ZARAFA: number of rooms or equipment available</Description>
        <Type>Integer</Type>
        <MultiValue>false</MultiValue>
        <Mandatory>false</Mandatory>
        <BlockedBy>
          <Attribute value="user">zarafaResourceType</Attribute>
          <Attribute value="equipment">zarafaResourceType</Attribute>
        </BlockedBy>
      </Attribute>
      <Attribute>
        <Name>zarafaAccount</Name>
        <Description>ZARAFA: entry is a part of zarafa</Description>
        <Type>Boolean</Type>
        <BackendType>Integer</BackendType>
        <InFilter>
            <FilterChain>
                <FilterEntry>
                    <Filter>
                        <Name>IntegerToBoolean</Name>
                    </Filter>
                </FilterEntry>
            </FilterChain>
        </InFilter>
        <OutFilter>
            <FilterChain>
                <FilterEntry>
                    <Filter>
                        <Name>BooleanToInteger</Name>
                    </Filter>
                </FilterEntry>
            </FilterChain>
        </OutFilter>
      </Attribute>
      <Attribute>
        <Name>zarafaHidden</Name>
        <Description>ZARAFA: This object should be hidden from address book</Description>
        <Type>Boolean</Type>
        <BackendType>Integer</BackendType>
        <InFilter>
            <FilterChain>
                <FilterEntry>
                    <Filter>
                        <Name>IntegerToBoolean</Name>
                    </Filter>
                </FilterEntry>
            </FilterChain>
        </InFilter>
        <OutFilter>
            <FilterChain>
                <FilterEntry>
                    <Filter>
                        <Name>BooleanToInteger</Name>
                    </Filter>
                </FilterEntry>
            </FilterChain>
        </OutFilter>
      </Attribute>
      <Attribute>
        <Name>enablePop3</Name>
        <Backend>NULL</Backend>
        <Type>Boolean</Type>
        <Default>false</Default>
        <Mandatory>true</Mandatory>
      </Attribute>
      <Attribute>
        <Name>enableImap</Name>
        <Backend>NULL</Backend>
        <Type>Boolean</Type>
        <Default>false</Default>
        <Mandatory>true</Mandatory>
      </Attribute>
      <Attribute>
        <Name>enableZPush</Name>
        <Backend>NULL</Backend>
        <Type>Boolean</Type>
        <Default>false</Default>
        <Mandatory>true</Mandatory>
      </Attribute>
      <Attribute>
        <Name>zarafaEnabledFeatures</Name>
        <Description>ZARAFA: This user has these features explicitly enabled</Description>
        <Type>UnicodeString</Type>
        <MultiValue>true</MultiValue>
        <Mandatory>false</Mandatory>
        <Auto>true</Auto>
        <ReadOnly>true</ReadOnly>
        <DependsOn>
          <Attribute>enablePop3</Attribute>
          <Attribute>enableImap</Attribute>
          <Attribute>enableZPush</Attribute>
        </DependsOn>
        <InFilter>
          <FilterChain>
            <FilterEntry>
              <Filter>
                <Name>ZarafaEnabledFeaturesIn</Name>
              </Filter>
            </FilterEntry>
          </FilterChain>
        </InFilter>
        <OutFilter>
          <FilterChain>
            <FilterEntry>
              <Filter>
                <Name>ZarafaEnabledFeaturesOut</Name>
              </Filter>
            </FilterEntry>
          </FilterChain>
        </OutFilter>
      </Attribute>
      <Attribute>
        <Name>zarafaDisabledFeatures</Name>
        <Description>ZARAFA: This user has these features explicitly disabled</Description>
        <Type>UnicodeString</Type>
        <MultiValue>true</MultiValue>
        <Auto>true</Auto>
        <DependsOn>
          <Attribute>enablePop3</Attribute>
          <Attribute>enableImap</Attribute>
          <Attribute>enableZPush</Attribute>
        </DependsOn>
        <OutFilter>
          <FilterChain>
            <FilterEntry>
              <Filter>
                <Name>ZarafaDisabledFeaturesOut</Name>
              </Filter>
            </FilterEntry>
          </FilterChain>
        </OutFilter>
        <ReadOnly>true</ReadOnly>
      </Attribute>
      <Attribute>
        <Name>zarafaUserArchiveServers</Name>
        <Description>ZARAFA: List of server names that contain an archive store for the user</Description>
        <Type>UnicodeString</Type>
        <MultiValue>true</MultiValue>
        <Validators>
          <Condition>
            <Name>ObjectWithPropertyExists</Name>
            <Param>Device</Param>
            <Param>goZarafaArchiveServer</Param>
            <Param>1</Param>
          </Condition>
        </Validators>
      </Attribute>
      <Attribute>
        <Name>mail</Name>
        <Description>RFC1274: RFC822 Mailbox</Description>
        <Type>UnicodeString</Type>
        <BackendType>String</BackendType>
        <InFilter>
          <FilterChain>
            <FilterEntry>
              <Filter>
                <Name>IdnaToUnicode</Name>
              </Filter>
            </FilterEntry>
          </FilterChain>
        </InFilter>
        <OutFilter>
          <FilterChain>
            <FilterEntry>
              <Filter>
                <Name>UnicodeToIdna</Name>
              </Filter>
            </FilterEntry>
          </FilterChain>
        </OutFilter>
        <MultiValue>false</MultiValue>
        <Mandatory>true</Mandatory>
        <Validators>
          <Condition>
            <Name>IsValidMailAddress</Name>
          </Condition>
        </Validators>
      </Attribute>
      <Attribute>
        <Name>gosaMailServer</Name>
        <Description>Specify users main mail server</Description>
        <Type>String</Type>
        <Mandatory>true</Mandatory>
        <Validators>
          <Condition>
            <Name>ObjectWithPropertyExists</Name>
            <Param>ZarafaServer</Param>
            <Param>cn</Param>
          </Condition>
        </Validators>
	<Values populate="getZarafaMailServers"/>
      </Attribute>
      <Attribute>
        <Name>inVacation</Name>
        <Description>Whether the account is in vacation</Description>
        <Backend>NULL</Backend>
        <Type>Boolean</Type>
        <Default>false</Default>
        <Mandatory>true</Mandatory>
      </Attribute>
      <Attribute>
        <Name>activateSpamFilter</Name>
        <Description>Whether to use a SPAM filter for the account</Description>
        <Backend>NULL</Backend>
        <Type>Boolean</Type>
        <Default>false</Default>
        <Mandatory>true</Mandatory>
      </Attribute>
      <Attribute>
        <Name>mailSizeFilter</Name>
        <Description>Whether to reject mails of certain size</Description>
        <Backend>NULL</Backend>
        <Type>Boolean</Type>
        <Default>false</Default>
        <Mandatory>true</Mandatory>
      </Attribute>
      <Attribute>
        <Name>localDelivery</Name>
        <Description>Whether to do a local delivery only</Description>
        <Backend>NULL</Backend>
        <Type>Boolean</Type>
        <Default>false</Default>
        <Mandatory>true</Mandatory>
      </Attribute>
      <Attribute>
        <Name>skipOwnMailbox</Name>
        <Description>Whether to skip insertion into the users own mailbox</Description>
        <Backend>NULL</Backend>
        <Type>Boolean</Type>
        <Default>false</Default>
        <Mandatory>true</Mandatory>
      </Attribute>
      <Attribute>
        <Name>customSieveScript</Name>
        <Description>Don't use GOsa 2.x build in sieve script generation</Description>
        <Backend>NULL</Backend>
        <Type>Boolean</Type>
        <Default>false</Default>
        <Mandatory>true</Mandatory>
      </Attribute>
      <Attribute>
        <Name>gosaMailDeliveryMode</Name>
        <Description>What to do with mails</Description>
        <Type>String</Type>
        <DependsOn>
          <Attribute>inVacation</Attribute>
          <Attribute>activateSpamFilter</Attribute>
          <Attribute>mailSizeFilter</Attribute>
          <Attribute>localDelivery</Attribute>
          <Attribute>skipOwnMailbox</Attribute>
          <Attribute>customSieveScript</Attribute>
        </DependsOn>
        <InFilter>
          <FilterChain>
            <FilterEntry>
              <Filter>
                <Name>MailDeliveryModeIn</Name>
              </Filter>
            </FilterEntry>
          </FilterChain>
        </InFilter>
        <OutFilter>
          <FilterChain>
            <FilterEntry>
              <Filter>
                <Name>MailDeliveryModeOut</Name>
              </Filter>
            </FilterEntry>
          </FilterChain>
        </OutFilter>
      </Attribute>
      <Attribute>
        <Name>gosaMailAlternateAddress</Name>
        <Description>Additional mail addresses where the user is reachable</Description>
        <Type>String</Type>
        <InFilter>
          <FilterChain>
            <FilterEntry>
              <Filter>
                <Name>IdnaToUnicode</Name>
              </Filter>
            </FilterEntry>
          </FilterChain>
        </InFilter>
        <OutFilter>
          <FilterChain>
            <FilterEntry>
              <Filter>
                <Name>UnicodeToIdna</Name>
              </Filter>
            </FilterEntry>
          </FilterChain>
        </OutFilter>
        <MultiValue>true</MultiValue>
        <Mandatory>false</Mandatory>
        <Validators>
          <Condition>
            <Name>IsValidMailAddress</Name>
          </Condition>
        </Validators>
      </Attribute>
      <Attribute>
        <Name>gosaMailForwardingAddress</Name>
        <Description>Addresses where to forward mail to</Description>
        <Type>UnicodeString</Type>
        <BackendType>String</BackendType>
        <InFilter>
          <FilterChain>
            <FilterEntry>
              <Filter>
                <Name>IdnaToUnicode</Name>
              </Filter>
            </FilterEntry>
          </FilterChain>
        </InFilter>
        <OutFilter>
          <FilterChain>
            <FilterEntry>
              <Filter>
                <Name>UnicodeToIdna</Name>
              </Filter>
            </FilterEntry>
          </FilterChain>
        </OutFilter>
        <MultiValue>true</MultiValue>
        <Mandatory>false</Mandatory>
        <Validators>
          <Condition>
            <Name>IsValidMailAddress</Name>
          </Condition>
        </Validators>
      </Attribute>
      <Attribute>
        <Name>gosaVacationMessage</Name>
        <Description>Text to display in case of vacation</Description>
        <Type>UnicodeString</Type>
        <BlockedBy>
          <Attribute value="false">inVacation</Attribute>
        </BlockedBy>
      </Attribute>
      <Attribute>
        <Name>gosaVacationStart</Name>
        <Description>Timestamp for enabling current vacation message</Description>
        <Type>Timestamp</Type>
        <MultiValue>false</MultiValue>
        <Mandatory>false</Mandatory>
        <BackendType>Integer</BackendType>
        <InFilter>
            <FilterChain>
                <FilterEntry>
                    <Filter>
                        <Name>IntegerToDatetime</Name>
                    </Filter>
                </FilterEntry>
            </FilterChain>
        </InFilter>
        <OutFilter>
            <FilterChain>
                <FilterEntry>
                    <Filter>
                        <Name>DatetimeToInteger</Name>
                    </Filter>
                </FilterEntry>
            </FilterChain>
        </OutFilter>
        <BlockedBy>
          <Attribute value="false">inVacation</Attribute>
        </BlockedBy>
      </Attribute>
      <Attribute>
        <Name>gosaVacationStop</Name>
        <Description>Timestamp for switching off current vacation message</Description>
        <Type>Timestamp</Type>
        <MultiValue>false</MultiValue>
        <Mandatory>false</Mandatory>
        <BackendType>Integer</BackendType>
        <InFilter>
            <FilterChain>
                <FilterEntry>
                    <Filter>
                        <Name>IntegerToDatetime</Name>
                    </Filter>
                </FilterEntry>
            </FilterChain>
        </InFilter>
        <OutFilter>
            <FilterChain>
                <FilterEntry>
                    <Filter>
                        <Name>DatetimeToInteger</Name>
                    </Filter>
                </FilterEntry>
            </FilterChain>
        </OutFilter>
        <BlockedBy>
          <Attribute value="false">inVacation</Attribute>
        </BlockedBy>
      </Attribute>
      <Attribute>
        <Name>goZarafaDisplayName</Name>
        <Description>goZarafa Display Name</Description>
        <Type>UnicodeString</Type>
        <Auto>true</Auto>
        <OutFilter>
          <FilterChain>
            <FilterEntry>
              <Filter>
                <Name>Clear</Name>
              </Filter>
            </FilterEntry>
            <FilterEntry>
              <Filter>
                <Name>ConcatString</Name>
                <Param>%(sn)s, %(givenName)s</Param>
                <Param>left</Param>
              </Filter>
            </FilterEntry>
          </FilterChain>
        </OutFilter>
        <ReadOnly>true</ReadOnly>
        <DependsOn>
          <Attribute>sn</Attribute>
          <Attribute>givenName</Attribute>
        </DependsOn>
      </Attribute>
    </Attributes>
    <Extends>
      <Value>User</Value>
    </Extends>
    <Find>
      <Aspect>
        <Tag>User</Tag>
        <Keyword>Mail</Keyword>
        <Keyword>Groupware</Keyword>
        <Keyword>Zarafa</Keyword>
        <Search>mil</Search>
        <Resolve filter="dn">manager</Resolve>
        <Result>
          <Map>
            <Source>mail</Source>
            <Destination>title</Destination>
          </Map>
        </Result>
      </Aspect>
    </Find>
  </Object>
</Objects>
