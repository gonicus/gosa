<?xml version="1.0" encoding="UTF-8"?>
<Objects xmlns="http://www.gonicus.de/Objects" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.gonicus.de/Objects ../object.xsd ">
  <Object>
    <Name>GroupOfNames</Name>
    <DisplayName>GroupOfNames</DisplayName>
    <Description>RFC2256: a group of names (DNs)</Description>
    <Backend>LDAP</Backend>
    <BackendParameters>
      <Backend objectClasses="groupOfNames" RDN="cn">LDAP</Backend>
      <Backend member="*:dn,">ObjectHandler</Backend>
    </BackendParameters>
    <BaseObject>true</BaseObject>
    <Templates>
      <Template>groupOfNames.json</Template>
    </Templates>
    <Attributes>
      <Attribute>
        <Name>cn</Name>
        <Description>Common Name</Description>
        <Type>UnicodeString</Type>
        <MultiValue>false</MultiValue>
        <Mandatory>true</Mandatory>
      </Attribute>
      <Attribute>
        <Name>description</Name>
        <Description>Description</Description>
        <Type>UnicodeString</Type>
        <MultiValue>false</MultiValue>
        <Mandatory>false</Mandatory>
      </Attribute>
      <Attribute>
        <Name>member</Name>
        <Description>RFC2256: member of a group</Description>
        <Type>UnicodeString</Type>
        <MultiValue>true</MultiValue>
        <Mandatory>true</Mandatory>
        <Validators>
          <ConditionOperator>
            <Operator>and</Operator>
            <LeftConditionChain>
              <ConditionOperator>
                <Operator>and</Operator>
                <LeftConditionChain>
                  <Condition>
                    <Name>IsExistingDN</Name>
                  </Condition>
                </LeftConditionChain>
                <RightConditionChain>
                  <Condition>
                    <Name>MaxAllowedTypes</Name>
                    <Param>2</Param>
                  </Condition>
                </RightConditionChain>
              </ConditionOperator>
            </LeftConditionChain>
            <RightConditionChain>
              <Condition>
                <Name>CheckExtensionConditions</Name>
                <Param>__self__</Param>
              </Condition>
            </RightConditionChain>
          </ConditionOperator>

        </Validators>
        <References>
          <Reference>
            <Object>*</Object>
            <Attribute>dn</Attribute>
          </Reference>
        </References>
        <InFilter>
          <FilterChain>
            <FilterEntry>
              <Filter>
                <Name>FilterOwnDn</Name>
              </Filter>
            </FilterEntry>
          </FilterChain>
        </InFilter>
        <OutFilter>
          <FilterChain>
            <FilterEntry>
              <Filter>
                <Name>AddOwnDnIfEmpty</Name>
              </Filter>
            </FilterEntry>
          </FilterChain>
        </OutFilter>
      </Attribute>
      <Attribute>
        <Name>businessCategory</Name>
        <Description>RFC2256: business category</Description>
        <Type>UnicodeString</Type>
        <MultiValue>false</MultiValue>
        <Mandatory>false</Mandatory>
      </Attribute>
      <Attribute>
        <Name>o</Name>
        <Description>RFC2256: organization this object belongs to</Description>
        <Type>UnicodeString</Type>
        <MultiValue>false</MultiValue>
        <Mandatory>false</Mandatory>
      </Attribute>
      <Attribute>
        <Name>owner</Name>
        <Description>RFC2256: owner (of the object)</Description>
        <Type>UnicodeString</Type>
        <MultiValue>false</MultiValue>
        <Mandatory>false</Mandatory>
        <Validators>
          <Condition>
            <Name>IsExistingDN</Name>
          </Condition>
        </Validators>
      </Attribute>
      <Attribute>
        <Name>ou</Name>
        <Description>RFC2256: organizational unit this object belongs to</Description>
        <Type>UnicodeString</Type>
        <MultiValue>false</MultiValue>
        <Mandatory>false</Mandatory>
      </Attribute>
      <Attribute>
        <Name>seeAlso</Name>
        <Description>RFC4519: DN of related object</Description>
        <Type>UnicodeString</Type>
        <MultiValue>false</MultiValue>
        <Mandatory>false</Mandatory>
        <Validators>
          <Condition>
            <Name>IsExistingDN</Name>
          </Condition>
        </Validators>
      </Attribute>
    </Attributes>
    <Find>
      <Aspect>
        <Tag>GroupOfNames</Tag>
        <Keyword>Group</Keyword>
        <Keyword>Member</Keyword>
        <Keyword>Membership</Keyword>
        <Search>cn</Search>
        <Search>description</Search>
        <Resolve type="*" filter="dn">member</Resolve>
        <Result>
          <Map>
            <Source>cn</Source>
            <Destination>title</Destination>
          </Map>
        </Result>
      </Aspect>
    </Find>
  </Object>
</Objects>
